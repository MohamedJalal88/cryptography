def score_text(text):
    english_freq = 'etaoinshrdlucmfwypvbgkqjxz'
    score = 0
    for char in text:
        if char in english_freq:
            score += (26 - english_freq.index(char))
    return score

def additive_attack(ciphertext, top_n=10):
    candidates = []
    
    for key in range(26):
        plaintext = ""
        for char in ciphertext:
            if char.isalpha():
                base = ord('a') if char.islower() else ord('A')
                shifted = (ord(char) - base - key) % 26
                plaintext += chr(base + shifted)
            else:
                plaintext += char
        
        score = score_text(plaintext.lower())
        candidates.append((score, plaintext, key))
    
    candidates.sort(key=lambda x: x[0], reverse=True)
    
    print(f"Top {top_n} Possible Plaintexts:")
    for i in range(min(top_n, len(candidates))):
        score, text, key = candidates[i]
        print(f"{i+1}. Key={key}: {text[:50]}...")

ciphertext = "wklv lv d vhfuhw phvvdjh wkdw qhhgv wr eh ghfubswhg"
additive_attack(ciphertext)
